# Repo Manager

## Описание
Repo Manager — это минималистичный менеджер репозиториев на Rust, который позволяет:

1. **Создавать и удалять категории (workspaces)** — организуйте репозитории по проектам
2. **Переименовывать workspaces** — нажмите на кнопку ✏ рядом с названием workspace
3. **Добавлять репозитории через drag-and-drop** — перетащите папку в окно, приложение найдет все git-репозитории внутри
4. **Автоматическое определение git-информации** — отображение текущей ветки, списка всех веток, статуса изменений
5. **Управление ветками** — переключение между ветками через dropdown
6. **Push/Pull операции** — кнопки с количеством коммитов ahead/behind для быстрого синхронизации
7. **Fetch операции** — индивидуальный fetch и массовый fetch для всех репозиториев
8. **Открытие папок** — клик по имени репозитория открывает папку в проводнике
9. **Автосохранение состояния** — все изменения сохраняются в `config.json`
10. **Автоинициализация при старте** — загружает git-информацию для всех репозиториев после перезапуска
11. **Сброс локальных изменений** — быстрое отбрасывание всех несохраненных правок
12. **Индикаторы синхронизации** — визуальная обратная связь при выполнении git-операций
13. **Адаптивный UI** — интерфейс подстраивается под размер экрана с ресайзабельными панелями
14. **Сохранение настроек** — размер окна, ширина панелей и настройки сортировки сохраняются между сессиями
15. **Поиск репозиториев** — быстрый поиск по имени или пути репозитория
16. **Сортировка репозиториев** — возможность сортировки по имени для удобной навигации
17. **Древовидное отображение** — полная иерархия файловой системы с возможностью сворачивания любых папок на любом уровне
18. **Система логирования** — встроенная панель логов с отображением всех git операций, ошибок и событий приложения

## Возможности

### Workspaces
- Создание новых workspace через кнопку "+ New Workspace"
- Переименование workspace: нажмите "»", введите новое имя в ограниченном поле и нажмите "✅" или Enter
- Удаление workspace через кнопку "❎" (закреплена справа)
- Переключение между workspace
- Ресайзабельная боковая панель (200-400px) с ограниченной шириной input'а при редактировании

### Репозитории
- **Drag & Drop**: Перетащите папку в окно приложения - приложение автоматически найдет все git-репозитории внутри
- **Рекурсивный поиск**: При добавлении папки автоматически сканируются все вложенные папки для поиска git-репозиториев
- **Асинхронный поиск**: Поиск выполняется в отдельном потоке, не блокируя UI
- **Умный поиск**: Автоматически пропускает системные папки (.git, node_modules, target, build)
- **Индикатор поиска**: Показывает процесс поиска и количество найденных репозиториев с анимацией
- **Индикатор загрузки**: При старте показывает прогресс загрузки git-информации для всех репозиториев
- **Древовидное отображение**: Полная иерархия файловой системы как в проводнике - каждая папка может содержать подпапки
- **Многоуровневое сворачивание**: Любую папку на любом уровне можно свернуть/развернуть независимо от других
- **Умный поиск**: Панель поиска работает по всем уровням дерева - найдет как репозитории, так и папки
- **Гибкая сортировка**: Checkbox "Сортировать по имени" упорядочивает содержимое внутри каждой папки отдельно
- **Встроенные логи**: Панель логов с трёхуровневой системой (Info/Warning/Error) и счетчиками событий
- **Детальное логирование**: Все git операции, ошибки и события отображаются с временными метками
- **Информация о ветках**: Автоматическое отображение текущей ветки и списка всех доступных веток
- **Переключение веток**: Dropdown для смены текущей ветки
- **Статус изменений**: Желтая точка ● показывает наличие незакоммиченных изменений
- **Push/Pull**: Кнопки ⬆ N и ⬇ N показывают количество коммитов для push/pull с подробными tooltip'ами
- **Открытие папки**: Клик по имени репозитория открывает папку в проводнике
- **Контекстное меню**: Кнопка "..." с опциями Fetch, Refresh, Reset local changes, Remove
- **Адаптивный табличный интерфейс**: Колонки автоматически подстраиваются под размер экрана
- **Скроллируемый список**: Автоматический скролл при большом количестве репозиториев
- **Tooltip'ы**: Подробные подсказки для всех кнопок и индикаторов
- **Индикаторы синхронизации**: Анимированные спиннеры при выполнении git-операций
- **Сброс локальных изменений**: Кнопка "Reset local changes" для отмены всех локальных правок

### Массовые операции
- **Refresh All**: Обновить git-информацию для всех репозиториев в workspace
- **Fetch All**: Выполнить `git fetch` для всех репозиториев в workspace

## Требования
- Rust (установить можно через [rustup](https://rustup.rs/))
- Git (должен быть доступен в PATH для выполнения команд)
- Cargo (устанавливается вместе с Rust)

## Сборка и запуск

1. Клонируйте репозиторий или скопируйте файлы проекта в локальную директорию.

```bash
# Клонирование репозитория
$ git clone git@github.com:Ariorh1337/repo-manager.git
$ cd repo-manager
```

2. Соберите проект в исполняемый файл:

```bash
$ cargo build --release
```

После успешной сборки исполняемый файл будет находиться в папке `target/release/`.

3. Запустите приложение:

```bash
$ cargo run
```

Или выполните исполняемый файл напрямую:

```bash
$ ./target/release/repo-manager
```

## Файлы конфигурации

Приложение автоматически сохраняет состояние в файл `config.json` в:
- windows - `%APPDATA%\RepoManager\config.json`
- macos   - `~/Library/Application Support/RepoManager/config.json`

Этот файл содержит:
- Список workspaces и их имена
- Пути к добавленным репозиториям
- Настройки приложения

При следующем запуске все данные будут автоматически восстановлены, включая:
- Автоматическую загрузку git-информации для всех репозиториев
- Восстановление структуры workspaces
- Асинхронное обновление статуса всех репозиториев

## Примечания
- Для работы drag-and-drop и открытия папок убедитесь, что у вас есть необходимые права доступа
- Git-команды выполняются через системный git, убедитесь что он установлен и доступен в PATH
- Приложение автоматически обновляет информацию о репозиториях в фоновом режиме
- При старте приложения происходит автоматическая инициализация всех сохраненных репозиториев
- При перетаскивании папки происходит рекурсивный поиск всех git-репозиториев внутри в отдельном потоке
- Автоматически пропускаются системные папки: .git, node_modules, target, build
- Используйте поиск для быстрого нахождения нужного репозитория в больших списках
- Настройки сортировки сохраняются между сессиями
- Размер окна и ширина панелей восстанавливаются при перезапуске приложения
- Если вы работаете в Windows, убедитесь, что исполняемый файл имеет доступ к файловой системе
- **Древовидное отображение**: Полная иерархия файловой системы с папками развернутыми по умолчанию
- **Многоуровневое сворачивание**: Кликните на любую папку `▼ папка` чтобы свернуть/развернуть её независимо от других
- **Умный поиск**: Поиск работает по всем уровням дерева - найдет как репозитории, так и папки
- **Гибкая сортировка**: При включении сортировки содержимое упорядочивается внутри каждой папки отдельно
- **Встроенные логи**: Кнопка "Show Logs" открывает панель с мониторингом всех git операций и ошибок

## Архитектура

Проект состоит из:
- `main.rs` — основная логика приложения и UI на egui
- `git_logic.rs` — модуль для работы с git-репозиториями
- `Cargo.toml` — зависимости проекта

### Особенности реализации
- **Многопоточность**: Git-операции и поиск репозиториев выполняются в отдельных потоках
- **Асинхронная коммуникация**: Потоки общаются с UI через каналы (crossbeam-channel)
- **Неблокирующий UI**: Интерфейс остается отзывчивым даже при выполнении длительных операций
- **Умное управление памятью**: Использование RefCell для безопасного разделения состояния
- **Отзывчивый интерфейс**: Адаптивная табличная структура с колонками:
  - Репозиторий (динамическая ширина) | Ветка (25% экрана, макс. 150px) | Статус (120px) | Действия (30px)
- **Адаптивность**: Автоматическое изменение размера колонок при изменении размера окна
- **Сохранение настроек**: Размер окна (1200x800 по умолчанию), ширина боковой панели и настройки сортировки автоматически сохраняются
- **Система логирования**: Встроенная панель логов для мониторинга всех операций, готовая для релизных сборок

### Пример интерфейса

```
▼ Job (2 элемента)
  ▼ Company-1 (80 элементов)
    ▼ repositories (80 элементов)
      ▼ project-group-1 (1 элемент)
          project-1       [main ▼]   [⬆ 2] [»]
      ▼ project-group-2 (75 элементов)
          project-1      [main ▼]   [⬇ 1] [»]
          project-2      [dev ▼]    [!]   [»]
          project-3       [main ▼]  [⬆ 3] [»]
          ...
      ▼ project-group-3 (1 элемент)
          project-1    [main ▼]   [!]   [»]
  ▼ Company-2 (65 элементов)
    ▼ some_folder (65 элементов)  
      ▼ repositories (65 элементов)
        ▼ project-group-1 (15 элементов)
            project-1    [dev ▼]    [⬇ 2] [»]
            project-2    [main ▼]   [⬆ 1] [»]
            ...
        ▼ project-group-2 (8 элементов)
            project-1   [main ▼]   [!]    [»]
            project-3   [dev ▼]    [⬆ 2]  [»]
            ...
```

**Навигация:**
- `▼`/`▶` — свернуть/развернуть любую папку на любом уровне
- **По умолчанию все развернуто** — сразу видна полная структура проекта
- Каждый уровень можно сворачивать независимо для фокуса на нужных областях
- Поиск работает по всем уровням дерева
- Сортировка применяется внутри каждой папки

**Элементы управления:**
- `▼`/`▶` — развернуть/свернуть группу
- `[main ▼]` — выбор ветки
- `[⬇ 2]` — pull (2 коммита на сервере)
- `[⬆ 1]` — push (1 локальный коммит)
- `[!]` — есть незакоммиченные изменения
- `[»]` — меню действий

## Зависимости
- **egui/eframe** — кроссплатформенный GUI фреймворк
- **gix** — библиотека для работы с git (для базовой проверки репозиториев)
- **serde/serde_json** — сериализация конфигурации
- **crossbeam-channel** — асинхронная обработка git-команд
- **opener** — открытие папок в системном проводнике

## Лицензия
Этот проект распространяется под лицензией Mozilla Public License Version 2.0.
